services:
  gasp-syncer:
    image: mangatasolutions/gasp-syncer:${GASP_SYNCER_VERSION:-local}
    restart: unless-stopped
    build:
      context: .
      dockerfile: src/bin/Dockerfile
      platforms: [linux/amd64]
      args:
        - BINARY_PATH=${GASP_SYNCER_BINARY_PATH:-target/release/main}
    depends_on:
      anvil:
        condition: service_healthy
      avs-3:
        condition: service_completed_successfully
    platform: linux/amd64
    environment:
      - RUST_LOG=info
      - SOURCE_RPC_URL=${ETH_RPC_URL:-http://anvil:8545}
      - SOURCE_WS_URL=${ETH_WS_URL:-ws://anvil:8545}
      - TARGET_RPC_URL=${ETH_RPC_URL:-http://anvil:8545}
      - TARGET_WS_URL=${ETH_WS_URL:-ws://anvil:8545}
      - SOURCE_CHAIN_ID=31337
      - TARGET_CHAIN_ID=31337
      - AVS_REGISTRY_COORDINATOR_ADDR=0x851356ae760d987E095750cCeb3bC6014560891C
      - TESTNET=true
  
